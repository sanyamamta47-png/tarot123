<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Mystic Tarot Reader</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&family=Quicksand:wght@300;500&display=swap" rel="stylesheet">
    <style>
        body {
            background: radial-gradient(circle at center, #fdfcfd 0%, #e2d7f5 100%);
            color: #4a3469;
            font-family: 'Quicksand', sans-serif;
            min-height: 100vh;
            width: 100vw;
            margin: 0;
            padding: 0;
            overflow-x: hidden;
            display: flex;
            flex-direction: column;
        }
        h1, h2, .mystic-font {
            font-family: 'Cinzel', serif;
        }
        .app-container {
            flex: 1;
            display: flex;
            flex-direction: column;
            padding: 5px;
            max-width: 600px;
            margin: 0 auto;
            width: 100%;
        }
        #selection-stage {
            height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            overflow: hidden;
            padding-bottom: 20px;
        }
        .card-table {
            border-collapse: separate;
            border-spacing: 2px;
            margin: 0 auto;
            table-layout: fixed;
        }
        .card-cell {
            height: 32px;
            width: 22px;
            perspective: 1000px;
            cursor: pointer;
        }
        @media (min-height: 650px) { .card-cell { height: 38px; width: 26px; } }
        @media (min-height: 750px) { .card-cell { height: 44px; width: 32px; } }
        @media (min-height: 850px) { .card-cell { height: 50px; width: 36px; } }
        
        .card-inner {
            position: relative;
            width: 100%;
            height: 100%;
            transition: transform 0.4s;
            transform-style: preserve-3d;
        }
        .card-cell.selected .card-inner {
            box-shadow: 0 0 15px #9d76cc;
            border-radius: 2px;
            transform: scale(1.15) translateY(-2px);
            z-index: 50;
        }
        .card-back {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            border-radius: 2px;
            border: 1px solid #c0a8e0;
            object-fit: cover;
            filter: sepia(0.1) brightness(1.05);
        }
        .reveal-container {
            display: none;
            animation: fadeIn 0.8s ease-out forwards;
            padding-bottom: 40px;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        @keyframes popUp {
            0% { transform: scale(0.8); opacity: 0; }
            70% { transform: scale(1.05); opacity: 1; }
            100% { transform: scale(1); opacity: 1; }
        }
        .reveal-btn-active {
            animation: popUp 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards;
            display: block !important;
        }
        .tarot-reveal-card {
            width: 240px;
            height: 410px;
            background: white;
            border: 3px solid #b191da;
            border-radius: 12px;
            padding: 10px;
            text-align: center;
            box-shadow: 0 10px 30px rgba(109, 40, 217, 0.2);
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        .card-art-img {
            width: 100%;
            height: 300px;
            object-fit: cover;
            border-radius: 4px;
            margin-bottom: 10px;
            border: 1px solid #e2d7f5;
        }
        .btn-mystic {
            background: linear-gradient(135deg, #9d76cc 0%, #7c3aed 100%);
            box-shadow: 0 4px 15px rgba(124, 58, 237, 0.3);
        }
        .light-panel {
            background: rgba(255, 255, 255, 0.65);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(139, 92, 246, 0.15);
        }
    </style>
</head>
<body>

    <div class="app-container">
        <div id="selection-stage">
            <header class="py-2 shrink-0">
                <h1 class="text-2xl text-purple-800 font-bold text-center">Mystic Tarot</h1>
                <p class="text-xs text-purple-600 font-medium text-center">Select 3 cards from the deck of 78</p>
            </header>

            <div class="flex-1 flex items-center justify-center overflow-hidden">
                <table class="card-table" id="tarot-grid"></table>
            </div>

            <footer class="py-2 shrink-0 flex flex-col items-center gap-2 min-h-[90px]">
                <span id="counter" class="text-sm font-bold italic text-purple-500">Selected: 0 / 3</span>
                <button id="reveal-btn" style="display: none;" onclick="revealDestiny()" class="btn-mystic text-white w-full py-4 rounded-xl font-bold uppercase tracking-widest text-sm transition-all active:scale-95">
                    Reveal My Destiny
                </button>
            </footer>
        </div>

        <div id="reveal-stage" class="reveal-container pt-4 px-4">
            <h2 class="text-2xl text-purple-800 mb-8 text-center">Your Sacred Reading</h2>
            <div class="flex flex-col gap-12 items-center mb-10">
                <div class="flex flex-col items-center">
                    <h3 class="mystic-font text-xs mb-4 text-purple-500 font-bold uppercase tracking-widest">The Past</h3>
                    <div id="card-0" class="tarot-reveal-card"></div>
                </div>
                <div class="flex flex-col items-center">
                    <h3 class="mystic-font text-xs mb-4 text-purple-500 font-bold uppercase tracking-widest">The Present</h3>
                    <div id="card-1" class="tarot-reveal-card"></div>
                </div>
                <div class="flex flex-col items-center">
                    <h3 class="mystic-font text-xs mb-4 text-purple-500 font-bold uppercase tracking-widest">The Future</h3>
                    <div id="card-2" class="tarot-reveal-card"></div>
                </div>
            </div>
            <div class="light-panel p-6 rounded-2xl mb-8">
                <p id="destiny-text" class="text-sm leading-relaxed italic text-purple-900 text-center"></p>
            </div>
            <button onclick="resetApp()" class="w-full bg-white border-2 border-purple-200 text-purple-600 font-bold py-3 rounded-xl mb-16 text-sm hover:bg-purple-50 transition-colors">
                New Reading
            </button>
        </div>
    </div>

    <script>
        const cardBackImg = "https://ik.imagekit.io/alj2mkmic/Tarot-card-back-design-Mystical-esoteri-Graphics-70846541-1-1-580x387.png";
        
        const majorArcana = [
            { name: "The Fool", meaning: "Innocence, new beginnings, free spirit.", img: "https://upload.wikimedia.org/wikipedia/commons/0/08/RWS_Tarot_00_Fool.jpg" },
            { name: "The Magician", meaning: "Manifestation, resourcefulness, power.", img: "https://upload.wikimedia.org/wikipedia/commons/d/de/RWS_Tarot_01_Magician.jpg" },
            { name: "The High Priestess", meaning: "Intuition, sacred knowledge, divine feminine.", img: "https://upload.wikimedia.org/wikipedia/commons/8/88/RWS_Tarot_02_High_Priestess.jpg" },
            { name: "The Empress", meaning: "Abundance, nature, femininity, fertility.", img: "https://upload.wikimedia.org/wikipedia/commons/d/d2/RWS_Tarot_03_Empress.jpg" },
            { name: "The Emperor", meaning: "Authority, structure, solid foundation.", img: "https://upload.wikimedia.org/wikipedia/commons/c/c3/RWS_Tarot_04_Emperor.jpg" },
            { name: "The Hierophant", meaning: "Tradition, spiritual wisdom, conformity.", img: "https://upload.wikimedia.org/wikipedia/commons/8/8d/RWS_Tarot_05_Hierophant.jpg" },
            { name: "The Lovers", meaning: "Love, harmony, choices, relationships.", img: "https://upload.wikimedia.org/wikipedia/commons/3/3a/TheLovers.jpg" },
            { name: "The Chariot", meaning: "Control, willpower, victory, determination.", img: "https://upload.wikimedia.org/wikipedia/commons/9/9b/RWS_Tarot_07_Chariot.jpg" },
            { name: "Strength", meaning: "Courage, persuasion, influence, compassion.", img: "https://upload.wikimedia.org/wikipedia/commons/f/f5/RWS_Tarot_08_Strength.jpg" },
            { name: "The Hermit", meaning: "Introspection, soul-searching, solitude.", img: "https://upload.wikimedia.org/wikipedia/commons/4/4d/RWS_Tarot_09_Hermit.jpg" },
            { name: "Wheel of Fortune", meaning: "Luck, karma, life cycles, destiny.", img: "https://upload.wikimedia.org/wikipedia/commons/3/3c/RWS_Tarot_10_Wheel_of_Fortune.jpg" },
            { name: "Justice", meaning: "Fairness, truth, law, accountability.", img: "https://upload.wikimedia.org/wikipedia/commons/e/e0/RWS_Tarot_11_Justice.jpg" },
            { name: "The Hanged Man", meaning: "Surrender, let go, new perspective.", img: "https://upload.wikimedia.org/wikipedia/commons/2/2b/RWS_Tarot_12_Hanged_Man.jpg" },
            { name: "Death", meaning: "Endings, change, transition, rebirth.", img: "https://upload.wikimedia.org/wikipedia/commons/d/d7/RWS_Tarot_13_Death.jpg" },
            { name: "Temperance", meaning: "Balance, moderation, patience, purpose.", img: "https://upload.wikimedia.org/wikipedia/commons/f/f8/RWS_Tarot_14_Temperance.jpg" },
            { name: "The Devil", meaning: "Shadow self, attachment, restriction.", img: "https://upload.wikimedia.org/wikipedia/commons/5/55/RWS_Tarot_15_Devil.jpg" },
            { name: "The Tower", meaning: "Sudden change, upheaval, revelation.", img: "https://upload.wikimedia.org/wikipedia/commons/5/53/RWS_Tarot_16_Tower.jpg" },
            { name: "The Star", meaning: "Hope, faith, renewal, inspiration.", img: "https://upload.wikimedia.org/wikipedia/commons/d/db/RWS_Tarot_17_Star.jpg" },
            { name: "The Moon", meaning: "Illusion, fear, anxiety, intuition.", img: "https://upload.wikimedia.org/wikipedia/commons/7/7f/RWS_Tarot_18_Moon.jpg" },
            { name: "The Sun", meaning: "Positivity, success, warmth, vitality.", img: "https://upload.wikimedia.org/wikipedia/commons/1/17/RWS_Tarot_19_Sun.jpg" },
            { name: "Judgement", meaning: "Judgement, rebirth, inner calling.", img: "https://upload.wikimedia.org/wikipedia/commons/d/dd/RWS_Tarot_20_Judgement.jpg" },
            { name: "The World", meaning: "Completion, integration, accomplishment.", img: "https://upload.wikimedia.org/wikipedia/commons/f/ff/RWS_Tarot_21_World.jpg" }
        ];

        const suits = ['Wands', 'Cups', 'Swords', 'Pentacles'];
        const values = ['Ace', 'Two', 'Three', 'Four', 'Five', 'Six', 'Seven', 'Eight', 'Nine', 'Ten', 'Page', 'Knight', 'Queen', 'King'];

        const suitImgMap = {
            'Wands': ['/1/11/Wands01.jpg', '/0/0f/Wands02.jpg', '/f/ff/Wands03.jpg', '/a/a4/Wands04.jpg', '/9/9d/Wands05.jpg', '/3/3b/Wands06.jpg', '/e/e4/Wands07.jpg', '/6/6b/Wands08.jpg', '/4/4d/Wands09.jpg', '/0/0b/Wands10.jpg', '/6/6a/Wands11.jpg', '/1/16/Wands12.jpg', '/0/0d/Wands13.jpg', '/1/11/Wands14.jpg'],
            'Cups': ['/3/36/Cups01.jpg', '/f/f8/Cups02.jpg', '/7/7a/Cups03.jpg', '/3/35/Cups04.jpg', '/d/d7/Cups05.jpg', '/1/17/Cups06.jpg', '/a/ae/Cups07.jpg', '/6/60/Cups08.jpg', '/2/24/Cups09.jpg', '/8/84/Cups10.jpg', '/a/ad/Cups11.jpg', '/f/fa/Cups12.jpg', '/6/62/Cups13.jpg', '/0/04/Cups14.jpg'],
            'Swords': ['/1/1a/Swords01.jpg', '/9/9e/Swords02.jpg', '/0/02/Swords03.jpg', '/b/bf/Swords04.jpg', '/2/23/Swords05.jpg', '/2/29/Swords06.jpg', '/3/34/Swords07.jpg', '/a/a7/Swords08.jpg', '/2/2f/Swords09.jpg', '/d/d4/Swords10.jpg', '/4/4c/Swords11.jpg', '/b/b0/Swords12.jpg', '/d/d4/Swords13.jpg', '/3/33/Swords14.jpg'],
            'Pentacles': ['/f/fd/Pents01.jpg', '/9/9f/Pents02.jpg', '/4/42/Pents03.jpg', '/a/a3/Pents04.jpg', '/9/96/Pents05.jpg', '/a/a6/Pents06.jpg', '/9/9a/Pents07.jpg', '/4/49/Pents08.jpg', '/f/f0/Pents09.jpg', '/4/42/Pents10.jpg', '/e/ec/Pents11.jpg', '/d/d5/Pents12.jpg', '/8/88/Pents13.jpg', '/1/1c/Pents14.jpg']
        };

        const minorArcana = [];
        const wikiPath = "https://upload.wikimedia.org/wikipedia/commons";
        
        suits.forEach(suit => {
            values.forEach((val, idx) => {
                minorArcana.push({
                    name: `${val} of ${suit}`,
                    meaning: `Aspects of ${suit.toLowerCase()} energy influencing your path.`,
                    img: `${wikiPath}${suitImgMap[suit][idx]}`
                });
            });
        });

        const fullDeck = [...majorArcana, ...minorArcana]; // 22 + 56 = 78 total
        let selectedIndices = [];

        function initGrid() {
            const grid = document.getElementById('tarot-grid');
            grid.innerHTML = '';
            let cardCount = 0;
            const rows = 13;
            const cols = 6;

            for (let r = 0; r < rows; r++) {
                let tr = document.createElement('tr');
                for (let c = 0; c < cols; c++) {
                    let td = document.createElement('td');
                    td.className = 'card-cell';
                    td.innerHTML = `
                        <div class="card-inner" onclick="toggleCard(this, ${cardCount})">
                            <img src="${cardBackImg}" alt="" class="card-back">
                        </div>
                    `;
                    tr.appendChild(td);
                    cardCount++;
                }
                grid.appendChild(tr);
            }
        }

        function toggleCard(element, index) {
            const parent = element.parentElement;
            if (parent.classList.contains('selected')) {
                parent.classList.remove('selected');
                selectedIndices = selectedIndices.filter(i => i !== index);
            } else {
                if (selectedIndices.length < 3) {
                    parent.classList.add('selected');
                    selectedIndices.push(index);
                }
            }
            updateUI();
        }

        function updateUI() {
            const counter = document.getElementById('counter');
            const btn = document.getElementById('reveal-btn');
            counter.innerText = `Selected: ${selectedIndices.length} / 3`;
            
            if (selectedIndices.length === 3) {
                btn.classList.add('reveal-btn-active');
                counter.classList.add('hidden');
            } else {
                btn.classList.remove('reveal-btn-active');
                btn.style.display = 'none';
                counter.classList.remove('hidden');
            }
        }

        function revealDestiny() {
            const shuffled = [...fullDeck].sort(() => 0.5 - Math.random());
            const selection = shuffled.slice(0, 3);

            document.getElementById('selection-stage').style.display = 'none';
            const revealStage = document.getElementById('reveal-stage');
            revealStage.style.display = 'block';
            document.body.style.overflow = 'auto';
            window.scrollTo(0, 0);

            selection.forEach((card, i) => {
                const container = document.getElementById(`card-${i}`);
                if (container) {
                    container.innerHTML = `
                        <img src="${card.img}" alt="${card.name}" class="card-art-img" loading="lazy" onerror="this.src='https://via.placeholder.com/240x410?text=${card.name.replace(/ /g, '+')}'">
                        <h4 class="mystic-font text-sm font-bold text-purple-900 mt-1">${card.name}</h4>
                        <p class="text-[10px] text-purple-500 font-bold uppercase tracking-widest mt-1 mb-1">Keywords</p>
                        <p class="text-xs px-2 text-purple-800 italic leading-tight">${card.meaning}</p>
                    `;
                }
            });

            document.getElementById('destiny-text').innerHTML = 
                `The universe reveals: Your journey is rooted in <strong>${selection[0].name}</strong>, moves through the energy of <strong>${selection[1].name}</strong>, and leads toward <strong>${selection[2].name}</strong>.`;
        }

        function resetApp() {
            selectedIndices = [];
            document.body.style.overflow = 'hidden';
            document.getElementById('selection-stage').style.display = 'flex';
            document.getElementById('reveal-stage').style.display = 'none';
            initGrid();
            updateUI();
        }

        window.onload = () => {
            document.body.style.overflow = 'hidden';
            initGrid();
        };
    </script>
</body>
</html>